# Обучение с учителем: качество модели

### Описание проекта

Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории. Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений.

«В один клик» — современная компания, поэтому её руководство не хочет принимать решения просто так — только на основе анализа данных и бизнес-моделирования. У компании есть небольшой отдел цифровых технологий, и вам предстоит побыть в роли стажёра в этом отделе.

## Навыки и инструменты

- **python**
- **pandas**
- **numpy**
- **matplotlib**
- **seaborn**
- **phik**
- **shap**
- sklearn.model_selection.**train_test_split**
- sklearn.pipeline.**Pipeline**
- sklearn.preprocessing.**OneHotEncoder**
- sklearn.preprocessing.**OrdinalEncoder**
- sklearn.preprocessing.**LabelEncoder**
- sklearn.preprocessing.**StandardScaler**
- sklearn.preprocessing.**MinMaxScaler**
- sklearn.compose.**ColumnTransformer**
- sklearn.impute.**SimpleImputer**
- sklearn.model_selection.**RandomizedSearchCV**
- sklearn.metrics.**roc_auc_score**
- sklearn.linear_model.**LogisticRegression**
- sklearn.neighbors.**KNeighborsClassifier**
- sklearn.tree.**DecisionTreeRegressor**
- sklearn.svm.**SVC**

## 

## Общий вывод

В ходе проекта:

Была произведена предобработка данных, исправлены ошибки в написании наименовании столбцов, приведены к единому регистру. 

Далее был произведен исследовательский анализ данных. Распределения признаков в целом нормальные. Отметили небольшой дисбаланс признаков - покупательская активность (преобладает класс с прежним уровнем активности), тип сервиса (преобладает класс с сервисом стандарт) и разрешение на сообщения о дополнительных предложениях (преобладает класс, разрешающий сообщения) Были отобраны клиенты с покупательской активностью не менее трех месяцев.

Произвели корреляционный анализ признаков. Отметили наличие высокой связи между признаками выручки в разные периоды, между длительностью регистрации покупателя и количеством неоплаченных продуктов, средним просмотром категорий и популярными категориями. Высокая связь между покупательской активностью и средним количеством страниц за визит.

Для поиска лучшей модели был использован общий пайплайн с подбором гиперпараметров
Были обучены четыре модели: KNeighborsClassifier(), DecisionTreeClassifier(), LogisticRegression() и SVC(). Для каждой подобраны гиперпараметры. Так как при анализе данных заметили небольшой дисбаланс классов, использовали метрику ROC-AUC для оценки качества модели.

Получили лучшую модель - SVC со со значением метрики ROC-AUC на тренировочной и тестовой выборке 0.91 и 0.89 соответственно.

Оценили важность признаков для лучшей модели и построили график важности с помощью метода SHAP.

Был выбран сегмент с высокой вероятностью снижения покупательской активности и высокой прибыльностью.

Предложения для увеличения покупательской активности:

- Так как большая доля акционных покупок сопуствует большому риску снижения активности, предполагаю, что нужно уменьшить маркетинговые активности подобного типа (например, не предлагать акции, но создать систему лояльности для покупателей)
- Для акций можно предложить делать более персонализированные предложения - в особенности для категорий товаров для детей, домашнего текстиля и косметики
- Также есть закономерность, что покупатели с типом сервиса премиум совершают меньше покупок по акции и не оставляют много товаров неоплаченными в корзине, но тем не менее проводят мало времени на сайте - необходимо сконцентрировать внимание на этой группе покупателей, разработать предложения или рекомендации.
- Для покупателей с типом сервиса стандарт - например, изменить систему и переводить на статус премиум раньше, чем предположительно через 400 дней от регистрации (или создать другую систему лояльности).
