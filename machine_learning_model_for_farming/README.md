# Разработка моделей машинного обучения для отбора коров к покупке

### Описание проекта

Вы работаете в IT-компании, которая выполняет на заказ проекты по машинному обучению. К вам обратился фермер, владелец молочного хозяйства «Вольный луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «ЭкоФерма».

Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже. А продавцы и технологи так и норовят приукрасить своих коровок!

Поэтому он просит вас разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке. «ЭкоФерма» готова предоставить подробные данные о своих коровах. Вам нужно создать две прогнозные модели для отбора бурёнок в поголовье:

- Первая будет прогнозировать возможный удой коровы (целевой признак Удой);
- Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока).

С помощью модели нужно отобрать коров по двум критериям:
- средний удой за год — не менее 6000 килограммов;
- молоко должно быть вкусным.

## Навыки и инструменты

- **python**
- **pandas**
- **numpy**
- **matplotlib**
- **seaborn**
- sklearn.model_selection.**train_test_split**
- sklearn.preprocessing.**OneHotEncoder**
- sklearn.preprocessing.**StandardScaler**
- sklearn.metrics.**accuracy_score**
- sklearn.metrics.**confusion_matrix**
- sklearn.metrics.**mean_absolute_error**
- sklearn.metrics.**mean_squared_error**
- sklearn.metrics.**precision_score**
- sklearn.metrics.**r2_score**
- sklearn.metrics.**recall_score**
- sklearn.linear_model.**LogisticRegression**
- sklearn.linear_model.**LinearRegression**

## 

## Общий вывод

В ходе проекта:

Была проведена предобработка данных - здесь были обнаружены явные и неявные дубликаты в датасетах (в названиях пород, типах пастбищ), были удалены и заменены все дубликаты, но в датасете с информацией о коровах к покупке было решено оставить дубликаты без изменений.

Исследовательский анализ данных - были построены графики распределения количественных и категориальных признаков в выборке. 

Корреляционный анализ - был построен график со значениями корреляции признаков, расчет производился по методу Спирмана, так как распределения некоторых признаков было ненормальным, по нему можно отметить наличие высокой связи между удоем и ЭКЕ, СПО. 

Обучение модели линейной регрессии - были построены три модели для прогноза удоя:

- первая модель - были выбраны следующие признаки : ЭКЕ, СПО, сырой протеин - признаки, связанные с кормом - могут напрямую влиять на размер удоя. Порода, порода папы-быка и возраст - биологические признаки, которые могут как напрямую так и наследственно влиять на размер удоя. Тип пастбища - увидели на диаграмме рассеяния, что этот признак также неким образом связан с удоем. Признаки, связанные с молоком отбросили: белок, жирность, не могут влиять на удой, так как эти признаки являются уже следствием удоя молока.
- вторая модель - попробовали исключить нелинейность связей признаков с целевым. Преобразовали СПО в категориальный бинарный признак, использовав границу между двумя кластерами из диаграммы рассеяния. Также ввели два новых признака: ЭКЕ в квадрате и сахар состава корма.
- третья модель - был введен новый признак - имя папы-быка.

- R2 1 модели: 0.784
- R2 2 модели: 0.819
- R2 3 модели: 0.827
- MSE 1 модели: 43887.015
- MSE 2 модели: 36892.861
- MSE 3 модели: 35197.049
- RMSE 1 модели: 209.492
- RMSE 2 модели: 192.075
- RMSE 3 модели: 187.609
- MAE 1 модели: 164.242
- MAE 2 модели: 148.717
- MAE 3 модели: 145.741

Далее был произведен прогноз удоя коров на данных датасета с коровами к покупке.

В результате проверки трех моделей для прогноза удоя была отобрана третья - с лучшими показателями метрик. Для прогноза вкуса молока коров было подобрано значение порога, для того, чтобы целевой признак был точно предсказан моделью.

Фермер может приобрести их с минимальным риском для себя - коровы с точностью дадут вкусное молоко и с вероятностью 83% удой будет свыше 6000 кг/год.

Рекомендации по улучшению моделей: Для улучшения показателей прогноза можно:

- добавить больше данных по высоким показателям удоя - тогда мы повысим дисперсию таргета и модель линейной регрессии будет давать прогноз с хорошими показателями.
- добавить новые признаки - например, признаки, связанные с показателями корма для коров или более точно определить их возраст - таким образом сможем повысить качество модели классификации (сейчас accuracy = 65%)
